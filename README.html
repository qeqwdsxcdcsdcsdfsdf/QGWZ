<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>第一个网页</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 0; }
        header, footer { background: #f0f0f0; padding: 20px; text-align: center; }
        nav { background: #333; padding: 10px; text-align: center; }
        nav a { color: #fff; margin: 0 10px; text-decoration: none; }
        main { padding: 20px; }

        .avatar {
            width: 100px;
            height: 100px;
            margin: 0 auto 10px auto;
            border-radius: 50%;
            overflow: hidden;
            border: 3px solid #ccc;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }
        .avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
            display: block;
            cursor: pointer;
        }
        .nav-btn {
            display: inline-block;
            background: rgba(120, 120, 120, 0.8);
            color: #fff;
            padding: 8px 20px;
            margin: 0 10px;
            border: none;
            border-radius: 20px;
            text-decoration: none;
            font-size: 16px;
            transition: background 0.3s;
            cursor: pointer;
        }
        .nav-btn:hover {
            background: rgba(80, 80, 80, 1);
        }
        .carousel {
            position: relative;
            width: 700px;
            height: 460px;
            margin: 0 auto 20px auto;
            overflow: hidden;
            background: #000;
        }
        .carousel-img {
            position: absolute;
            left: 0; top: 0;
            width: 100%; height: 100%;
            object-fit: contain;
            transition: transform 0.5s, opacity 0.5s;
            background: #000;
        }
        .carousel-controls button {
            margin: 10px 5px;
            padding: 6px 16px;
            border: none;
            border-radius: 6px;
            background: #888;
            color: #fff;
            cursor: pointer;
            font-size: 15px;
            transition: background 0.3s;
        }
        .carousel-controls button:hover {
            background: #555;
        }
        @keyframes rotate-music {
            0% { transform: rotate(0deg);}
            100% { transform: rotate(360deg);}
        }
        .music-rotating {
            animation: rotate-music 1s linear infinite;
        }
        #music-btn-img {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            object-fit: cover;
            display: block;
        }
    </style>
</head>
<body>
    <header style="background: url('img/背景.jpg') center/cover no-repeat; padding: 40px 20px; text-align: center; position: relative;">
        <!-- 播放、切歌、歌单按钮左上角排列，播放按钮居中 -->
        <div style="position: absolute; top: 20px; left: 30px; display: flex; align-items: center; gap: 10px; z-index: 10;">
            <button id="prev-music" style="background: rgba(0,0,0,0.4); color: #fff; border: none; border-radius: 50%; width: 36px; height: 36px; cursor: pointer; font-size: 20px; transition: background 0.3s;">
                &#9198;
            </button>
            <button id="music-btn" style="background: rgba(0,0,0,0.4); color: #fff; border: none; border-radius: 50%; width: 44px; height: 44px; cursor: pointer; font-size: 22px; transition: background 0.3s;">
                <img id="music-btn-img" src="img/头像.jpg" alt="播放" style="width:28px;height:28px;vertical-align:middle;" />
            </button>
            <button id="next-music" style="background: rgba(0,0,0,0.4); color: #fff; border: none; border-radius: 50%; width: 36px; height: 36px; cursor: pointer; font-size: 20px; transition: background 0.3s;">
                &#9197;
            </button>
            <button id="playlist-btn" style="background: rgba(0,0,0,0.4); color: #fff; border: none; border-radius: 12px; width: 60px; height: 36px; cursor: pointer; font-size: 16px; transition: background 0.3s; position: relative; z-index: 11;">
                歌单
            </button>
        </div>
        <audio id="music-audio" src="music/晴天.mp3"></audio>
        <!-- 歌单弹窗，按钮下方下拉展开 -->
        <div id="playlist-modal" style="display:none; position:fixed; left:0; top:0; width:100vw; height:100vh; background:rgba(0,0,0,0.4); z-index:9999;">
            <div id="playlist-popup" style="background:rgba(0,0,0,0.4); width:300px; padding:20px; border-radius:12px; position:absolute; box-shadow:0 8px 32px rgba(0,0,0,0.2); opacity:0; transform:scaleY(0.2); transition:all 0.3s cubic-bezier(.68,-0.55,.27,1.55); color:#fff;">
                <h3 style="margin-top:0;">歌单</h3>
                <ul id="playlist-list" style="list-style:none; padding:0; margin:0;"></ul>
                <button id="close-playlist" style="position:absolute; top:10px; right:10px; background:rgba(255,255,255,0.3); color:#fff; border:none; border-radius:50%; width:28px; height:28px; cursor:pointer;">×</button>
            </div>
        </div>
        <div class="avatar" style="position: relative;">
            <img id="avatar-img" src="img/头像.jpg" alt="头像" />
            <input type="file" id="avatar-upload" accept="image/*" style="display:none;" />
            <button id="change-avatar-btn" style="display:none;"></button>
        </div>
        <h1 style="color: rgb(0, 179, 255);">QG.乂氼</h1>
    </header>
    <nav>
        <a href="#" class="nav-btn">首页</a>
        <a href="#" class="nav-btn">关于</a>
        <a href="#" class="nav-btn">个人介绍</a>
        <a href="#" class="nav-btn">联系</a>
    </nav>
    <main>
        <h2>哦吼，我的自恋照！</h2>
        <div class="carousel">
            <img class="carousel-img" src="img/照片1.jpg" />
            <img class="carousel-img" src="img/照片2.jpg" />
            <img class="carousel-img" src="img/照片3.jpg" />
            <img class="carousel-img" src="img/照片4.jpg" />
        </div>
        <p>这里是内容区域。</p>
    </main>
    <footer>
        &copy; 2025 我的网页
    </footer>
    <script>
        // 轮播图切换
        const imgs = document.querySelectorAll('.carousel-img');
        let current = 0;
        let isSliding = false;

        function showImg(idx, direction = 1) {
            if (isSliding) return;
            isSliding = true;
            imgs.forEach((img, i) => {
                img.style.transition = 'none';
                if (i === current) {
                    img.style.transform = 'translateX(0)';
                    img.style.opacity = '1';
                    img.style.zIndex = '2';
                } else {
                    img.style.transform = `translateX(${direction > 0 ? '100%' : '-100%'})`;
                    img.style.opacity = '0';
                    img.style.zIndex = '1';
                }
            });
            setTimeout(() => {
                imgs[current].style.transition = 'transform 0.5s, opacity 0.5s';
                imgs[current].style.transform = `translateX(${direction > 0 ? '-100%' : '100%'})`;
                imgs[current].style.opacity = '0';
                imgs[current].style.zIndex = '1';

                imgs[idx].style.transition = 'transform 0.5s, opacity 0.5s';
                imgs[idx].style.transform = 'translateX(0)';
                imgs[idx].style.opacity = '1';
                imgs[idx].style.zIndex = '2';

                setTimeout(() => {
                    current = idx;
                    isSliding = false;
                }, 500);
            }, 20);
        }

        function prevImg() {
            let next = (current - 1 + imgs.length) % imgs.length;
            showImg(next, -1);
        }
        function nextImg() {
            let next = (current + 1) % imgs.length;
            showImg(next, 1);
        }
        // 自动轮播
        setInterval(function() {
            nextImg();
        }, 3000);

        // 初始化
        imgs.forEach((img, i) => {
            img.style.transform = i === 0 ? 'translateX(0)' : 'translateX(100%)';
            img.style.opacity = i === 0 ? '1' : '0';
            img.style.zIndex = i === 0 ? '2' : '1';
        });

        // 音乐播放与切歌
        const musicList = [
            {name: '晴天', src: 'music/晴天.mp3'},
            {name: '稻香', src: 'music/稻香.mp3'},
            {name: '花海', src: 'music/花海.mp3'}
        ];
        let musicIndex = 0;
        const musicBtn = document.getElementById('music-btn');
        const prevMusicBtn = document.getElementById('prev-music');
        const nextMusicBtn = document.getElementById('next-music');
        const musicAudio = document.getElementById('music-audio');
        const playlistBtn = document.getElementById('playlist-btn');
        const playlistModal = document.getElementById('playlist-modal');
        const playlistPopup = document.getElementById('playlist-popup');
        const playlistList = document.getElementById('playlist-list');
        const closePlaylist = document.getElementById('close-playlist');
        let playing = false;

        function loadMusic(idx) {
            musicAudio.src = musicList[idx].src;
            if (playing) musicAudio.play();
        }

        // 替换播放/暂停按钮图片
        const musicBtnImg = document.getElementById('music-btn-img');
        musicBtn.onclick = function() {
            if (playing) {
                musicAudio.pause();
                playing = false;
                musicBtn.style.background = "rgba(0,0,0,0.4)";
                musicBtn.classList.remove('music-rotating');
                musicBtnImg.src = "img/头像.jpg"; // 可替换为播放图片
            } else {
                musicAudio.play();
                playing = true;
                musicBtn.style.background = "rgba(0,179,255,0.7)";
                musicBtn.classList.add('music-rotating');
                musicBtnImg.src = "img/头像.jpg"; // 可替换为暂停图片
            }
        };

        prevMusicBtn.onclick = function() {
            musicIndex = (musicIndex - 1 + musicList.length) % musicList.length;
            loadMusic(musicIndex);
        };

        nextMusicBtn.onclick = function() {
            musicIndex = (musicIndex + 1) % musicList.length;
            loadMusic(musicIndex);
        };

        // 自动切到下一首
        musicAudio.onended = function() {
            nextMusicBtn.click();
        };

        // 歌单弹窗特效（弹窗从按钮下方下拉展开）
        playlistBtn.onclick = function(e) {
            const btnRect = playlistBtn.getBoundingClientRect();
            playlistPopup.style.left = btnRect.left + 'px';
            playlistPopup.style.top = (btnRect.bottom + 6) + 'px';
            playlistPopup.style.width = btnRect.width + 40 + 'px';
            playlistPopup.style.opacity = '0';
            playlistPopup.style.transform = 'scaleY(0.2)';
            playlistPopup.style.transition = 'all 0.3s cubic-bezier(.68,-0.55,.27,1.55)';
            playlistModal.style.display = 'block';
            playlistList.innerHTML = '';
            musicList.forEach((item, idx) => {
                const li = document.createElement('li');
                li.textContent = item.name;
                li.style.padding = '8px 0';
                li.style.cursor = 'pointer';
                li.style.color = idx === musicIndex ? '#2196f3' : '#fff';
                li.onclick = function() {
                    musicIndex = idx;
                    loadMusic(musicIndex);
                    playlistModal.style.display = 'none';
                };
                playlistList.appendChild(li);
            });
            setTimeout(() => {
                playlistPopup.style.opacity = '1';
                playlistPopup.style.transform = 'scaleY(1)';
            }, 10);
        };
        closePlaylist.onclick = function() {
            playlistPopup.style.opacity = '0';
            playlistPopup.style.transform = 'scaleY(0.2)';
            setTimeout(() => {
                playlistModal.style.display = 'none';
            }, 300);
        };
        playlistModal.onclick = function(e) {
            if (e.target === playlistModal) {
                closePlaylist.onclick();
            }
        };

        // 自动播放第一首歌曲
        window.addEventListener('DOMContentLoaded', function() {
            musicAudio.src = musicList[0].src;
            musicAudio.play();
            playing = true;
            musicBtn.style.background = "rgba(0,179,255,0.7)";
            musicBtn.classList.add('music-rotating');
        });

        // 头像更换功能（点击头像图片也能切换）
        const avatarImg = document.getElementById('avatar-img');
        const avatarUpload = document.getElementById('avatar-upload');
        const changeAvatarBtn = document.getElementById('change-avatar-btn');

        changeAvatarBtn.onclick = function() {
            avatarUpload.click();
        };
        avatarImg.onclick = function() {
            avatarUpload.click();
        };
        avatarUpload.onchange = function(e) {
            const file = e.target.files[0];
            if (file && file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = function(evt) {
                    avatarImg.src = evt.target.result;
                    // 如果播放按钮也用头像图片同步更换
                    const musicBtnImg = document.getElementById('music-btn-img');
                    if (musicBtnImg) musicBtnImg.src = evt.target.result;
                };
                reader.readAsDataURL(file);
            }
        };
    </script>
</body>
</html>
